<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/plex/css/ibm-plex.css" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.min.js"></script>
    <script src="https://quantumexperience.cdnedge.bluemix.net/ibm-q-navigation/latest/ibm_q_navigation.min.js"></script>
    <link rel="stylesheet" href="https://quantumexperience.cdnedge.bluemix.net/ibm-q-navigation/latest/ibm_q_navigation.css">
    
    <title>Basic Circuit Identities and Larger Circuits &#8212; Full User Guide 2.0 documentation</title>

    <link rel="stylesheet" href="../_static/material-icons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material-design-lite-1.3.0/material.blue-indigo.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_materialdesign_theme.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/themeExt.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Grover’s Algorithm" href="070-Grover&#39;s_Algorithm.html" />
    <link rel="prev" title="Quantum Algorithms" href="060-Quantum_Algorithms.html" /> 
  </head>
<body>
  <div id="q-navigation"></div>
  <script>
  ibm_q_navigation.default.load(
    '#q-navigation', // element selector to put the navigation component
    'IBM Q', // Brand name
    null,
    null,
    true, // should the action buttons (search and signin) be hidden
    true // use absolute paths for all the urls
  );
  </script>
    <div class="mdl-layout mdl-js-layout  mdl-layout--fixed-drawer"><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../introduction.html">
              <span class="title-text">
                  Full User Guide
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../000-FAQ/000-Frequently_Asked_Questions.html">Frequently Asked Questions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../001-The_IBM_Q_Experience/001-Introducing_the_IBM_Q_Experience.html">Introducing the IBM Q Experience</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/002-The_Quantum_World.html">The Quantum World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/003-The_Quantum_Composer.html">The Quantum Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/004-Running_your_Quantum_Scores.html">Running your Quantum Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/005-The_Results.html">The Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/000-The_Weird_and_Wonderful_World_of_the_Qubit.html">The Wonderful World of the Qubit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/001-The_Quantum_Bit_(Qubit).html">The Quantum Bit (Qubit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/002-Creating_superpositions.html">Creating Superpositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/003-Introducing_qubit_phase.html">Introducing Qubit Phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/004-advanced_qubit_gates.html">Advanced Single-Qubit Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/005-The_Bloch_Sphere.html">The Bloch Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/006-Decoherence.html">Decoherence</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/000-Multiple_Qubits_Gates_and_Entangled_States.html">Multi-Qubit Gates and Entangled States</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/001-Multiple_Qubits.html">Multiple Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/002-Entanglement_and_Bell_Tests.html">Entanglement and Bell Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/003-GHZ_States.html">GHZ States</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="060-Quantum_Algorithms.html">Quantum Algorithms</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basic Circuit Identities and Larger Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="070-Grover's_Algorithm.html">Grover’s Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="080-Deutsch-Jozsa_Algorithm.html">Deutsch-Jozsa Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="081-Learning_Parity_with_Noise.html">Learning Parity with Noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="100-Quantum_Phase_Estimation.html">Quantum Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="110-Shor's_algorithm.html">Shor’s algorithm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../005-Quantum_Error_Correction/059-Quantum_Error_Correction.html">Quantum Error Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../005-Quantum_Error_Correction/060-Quantum_Repetition_Code.html">Quantum Repetition Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../005-Quantum_Error_Correction/061-Stabilizer_Measurements.html">Stabilizer Measurements</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">
<header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../introduction.html">
              <span class="title-text">
                  Full User Guide
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../000-FAQ/000-Frequently_Asked_Questions.html">Frequently Asked Questions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../001-The_IBM_Q_Experience/001-Introducing_the_IBM_Q_Experience.html">Introducing the IBM Q Experience</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/002-The_Quantum_World.html">The Quantum World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/003-The_Quantum_Composer.html">The Quantum Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/004-Running_your_Quantum_Scores.html">Running your Quantum Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../001-The_IBM_Q_Experience/005-The_Results.html">The Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/000-The_Weird_and_Wonderful_World_of_the_Qubit.html">The Wonderful World of the Qubit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/001-The_Quantum_Bit_(Qubit).html">The Quantum Bit (Qubit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/002-Creating_superpositions.html">Creating Superpositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/003-Introducing_qubit_phase.html">Introducing Qubit Phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/004-advanced_qubit_gates.html">Advanced Single-Qubit Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/005-The_Bloch_Sphere.html">The Bloch Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002-The_Weird_and_Wonderful_World_of_the_Qubit/006-Decoherence.html">Decoherence</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/000-Multiple_Qubits_Gates_and_Entangled_States.html">Multi-Qubit Gates and Entangled States</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/001-Multiple_Qubits.html">Multiple Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/002-Entanglement_and_Bell_Tests.html">Entanglement and Bell Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../003-Multiple_Qubits_Gates_and_Entangled_States/003-GHZ_States.html">GHZ States</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="060-Quantum_Algorithms.html">Quantum Algorithms</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basic Circuit Identities and Larger Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="070-Grover's_Algorithm.html">Grover’s Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="080-Deutsch-Jozsa_Algorithm.html">Deutsch-Jozsa Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="081-Learning_Parity_with_Noise.html">Learning Parity with Noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="100-Quantum_Phase_Estimation.html">Quantum Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="110-Shor's_algorithm.html">Shor’s algorithm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../005-Quantum_Error_Correction/059-Quantum_Error_Correction.html">Quantum Error Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../005-Quantum_Error_Correction/060-Quantum_Repetition_Code.html">Quantum Repetition Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../005-Quantum_Error_Correction/061-Stabilizer_Measurements.html">Stabilizer Measurements</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content">
        
  <div class="section" id="basic-circuit-identities-and-larger-circuits">
<h1>Basic Circuit Identities and Larger Circuits<a class="headerlink" href="#basic-circuit-identities-and-larger-circuits" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">There are several facts about quantum circuits that can be used to
express more complicated <a class="reference external" href="https://en.wikipedia.org/wiki/Unitary_transformation">unitary
transformations</a>,
write circuits more concisely, or adapt circuits to experimental
constraints.</div>
</div>
<div class="section" id="changing-the-direction-of-a-cnot-gate">
<h2>Changing the direction of a CNOT gate<a class="headerlink" href="#changing-the-direction-of-a-cnot-gate" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">In the first example “CNOT (Reverse),” we consider how to implement a
CNOT gate from control qubit 2 to target qubit 1 (notated
<span class="math notranslate nohighlight">\(CNOT_{21}\)</span>) using a CNOT gate that acts in the opposite direction,
from control qubit 1 to target qubit 2, <span class="math notranslate nohighlight">\(CNOT_{12}\)</span>. By multiplying
the matrices for each gate, you can convince yourself that
<span class="math notranslate nohighlight">\((H\otimes H)CNOT_{12}(H\otimes H)=CNOT_{21}\)</span>.</div>
</div>
<p><img alt="image0" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/cnot_reversetvhxy1y40307ldi.png" /></p>
<div class="line-block">
<div class="line">The <a class="reference external" href="https://en.wikipedia.org/wiki/Kronecker_product">Kronecker
product</a>
<span class="math notranslate nohighlight">\(H\otimes H\)</span> in this equation is equal to a four-by-four matrix
<span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2}}\begin{pmatrix} H &amp; H \\ H &amp;
-H\end{pmatrix}\)</span>. If you run the example, you will confirm that this
combination of Hadamard and CNOT gates implements a CNOT gate in the
opposite direction. The <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_gate#Pauli-X_gate">Pauli</a>
<span class="math notranslate nohighlight">\(X\)</span> acts
to invert the control qubit 2, and the result is <span class="math notranslate nohighlight">\(|11\rangle\)</span> as
expected for <span class="math notranslate nohighlight">\(CNOT_{21}\)</span>.</div>
</div>
</div>
<div class="section" id="swapping-the-states-of-qubits">
<h2>Swapping the states of qubits<a class="headerlink" href="#swapping-the-states-of-qubits" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Our second example, “Swap,” demonstrates a building block that allows
you to permute the information stored in a set of qubits. Suppose we
want to exchange the states of a pair of qubits by implementing a SWAP
gate on the pair. There is no SWAP gate in our basis, but we can
construct one from three CNOT gates
<span class="math notranslate nohighlight">\(SWAP_{12}=CNOT_{12}CNOT_{21}CNOT_{12}\)</span>.</div>
</div>
<p><img alt="image1" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/swapedtm8jhiv1ckgldi.png" /></p>
<p>To see that this is true, it is enough to look at what happens to each
classical state <span class="math notranslate nohighlight">\(00\)</span>, <span class="math notranslate nohighlight">\(01\)</span>, <span class="math notranslate nohighlight">\(10\)</span>, and <span class="math notranslate nohighlight">\(11\)</span>. Let’s consider <span class="math notranslate nohighlight">\(01\)</span>. The
first gate <span class="math notranslate nohighlight">\(CNOT_{12}\)</span> does nothing since the control is <span class="math notranslate nohighlight">\(0\)</span>. The
second gate <span class="math notranslate nohighlight">\(CNOT_{21}\)</span> flips the first qubit, so we have <span class="math notranslate nohighlight">\(11\)</span>.
Finally, the last <span class="math notranslate nohighlight">\(CNOT_{12}\)</span> flips the second qubit and we get <span class="math notranslate nohighlight">\(10\)</span>.
The <span class="math notranslate nohighlight">\(1\)</span> has moved from the second qubit to the first. The other cases
can be worked out similarly. Now you can see this for yourself by
running the “Swap” example below. Notice that we have used the “CNOT
(Reverse)” identity to change the direction of the <span class="math notranslate nohighlight">\(CNOT_{21}\)</span> gate,
since this is necessary to run the example on the real device. Try
deleting the Pauli <span class="math notranslate nohighlight">\(X\)</span> and placing a Pauli <span class="math notranslate nohighlight">\(X\)</span> on qubit 1 instead.</p>
<div class="line-block">
<div class="line">In the experimental device, not all qubits are connected to each
other; therefore, some two-qubit gates cannot be applied directly. In
the third example, “Swap Q0 with Q1,” we show how to swap a pair of
qubits that are not directly connected to each other but share a
common neighbor (in this case Q2). The state <span class="math notranslate nohighlight">\(|+\rangle\)</span>, prepared
by the first Hadamard gate on <span class="math notranslate nohighlight">\(Q_0\)</span>, is swapped into <span class="math notranslate nohighlight">\(Q_1\)</span> by three
successive SWAP gates.</div>
</div>
</div>
<div class="section" id="adding-a-control-qubit-to-a-gate">
<h2>Adding a control qubit to a gate<a class="headerlink" href="#adding-a-control-qubit-to-a-gate" title="Permalink to this headline">¶</a></h2>
<p>Some unitary transformations can be constructed exactly using gates in
our basis. One set of transformations we use regularly are
controlled-Pauli operations, where we apply a Pauli gate to a target
qubit if a control qubit is <span class="math notranslate nohighlight">\(|1\rangle\)</span>. The CNOT gate is a
controlled-<span class="math notranslate nohighlight">\(X\)</span> gate. Since we know that <span class="math notranslate nohighlight">\(HXH=Z\)</span> and <span class="math notranslate nohighlight">\(SXS^\dagger=Y\)</span>,
and furthermore that <span class="math notranslate nohighlight">\(HH=I\)</span> and <span class="math notranslate nohighlight">\(SS^\dagger=I\)</span>, it is straightforward
to construct circuits for controlled-<span class="math notranslate nohighlight">\(Z\)</span> and controlled-<span class="math notranslate nohighlight">\(Y\)</span>. This is
illustrated in the following figure, where <span class="math notranslate nohighlight">\(P\)</span> is a Pauli gate <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>,
or <span class="math notranslate nohighlight">\(Z\)</span>, and <span class="math notranslate nohighlight">\(C\)</span> is a Clifford operation such as <span class="math notranslate nohighlight">\(I\)</span>, <span class="math notranslate nohighlight">\(S\)</span>, or <span class="math notranslate nohighlight">\(H\)</span>.</p>
<div class="line-block">
<div class="line"><img alt="image2" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/cPauli51b90orbw2zc9pb9.png" /></div>
</div>
<div class="line-block">
<div class="line">For a more involved example, let’s add a control qubit to a Hadamard
gate to implement a controlled-Hadamard operation:</div>
</div>
<div class="line-block">
<div class="line"><img alt="image3" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/c-Hcmvfpboi12359udi.png" /></div>
</div>
<p>It turns out that we can write down a circuit for a controlled-<span class="math notranslate nohighlight">\(V\)</span>
operation if we can find three circuits <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span> such that
<span class="math notranslate nohighlight">\(ABC=I\)</span> and <span class="math notranslate nohighlight">\(e^{i\alpha}AZBZC=V\)</span> [<a class="reference external" href="http://journals.aps.org/pra/abstract/10.1103/PhysRevA.52.3457?cm_mc_uid=43781767191014577577895&amp;cm_mc_sid_50200000=1460741020">Barenco et al.,
1995</a>].
There is a general recipe for doing this, but we will just write down a
solution for when <span class="math notranslate nohighlight">\(V=H\)</span> that you can check for yourself:
<span class="math notranslate nohighlight">\(A=e^{i3\pi/8}XSHTHS^\dagger\)</span>, <span class="math notranslate nohighlight">\(B=e^{-i\pi/8}SHT^\dagger
HS^\dagger HSH\)</span>, <span class="math notranslate nohighlight">\(C=e^{-i\pi/4}HSH\)</span>, and <span class="math notranslate nohighlight">\(e^{i\alpha}=-i\)</span>.
Combining these circuits as shown here</p>
<p><img alt="image4" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/add-controldfjvwzojd8udte29.png" /></p>
<div class="line-block">
<div class="line">and making some simplifications, we get the result shown in the fourth
example, “controlled-Hadamard.” This example applies a Hadamard gate
to the control qubit, <span class="math notranslate nohighlight">\(Q_0\)</span>, and then applies the controlled-Hadamard
circuit from <span class="math notranslate nohighlight">\(Q_0\)</span> to <span class="math notranslate nohighlight">\(Q_2\)</span>. This creates the output state
<span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2}}\left(|00\rangle+|1+\rangle\right)=\frac{1}{\sqrt{2}}|00\rangle+\frac{1}{2}|10\rangle+\frac{1}{2}|11\rangle\)</span>.
Try deleting the first Hadamard gate on <span class="math notranslate nohighlight">\(Q_0\)</span> and replacing it with a
bit-flip (<span class="math notranslate nohighlight">\(X\)</span>) to see what happens. Can you implement circuits for
other controlled gates, such as a controlled-S?</div>
</div>
</div>
<div class="section" id="approximating-a-unitary-transformation">
<h2>Approximating a unitary transformation<a class="headerlink" href="#approximating-a-unitary-transformation" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Most unitary transformations cannot be written exactly using the gates
we have in our basis; but because our basis is a discrete universal
set, it <em>is</em> possible to approximate any unitary transformation to any
accuracy. Let’s see an example of this. The <span class="math notranslate nohighlight">\(\sqrt{T}\)</span> unitary
transformation cannot be written exactly using our basis. Since
<span class="math notranslate nohighlight">\(\sqrt{T}\)</span> is a <span class="math notranslate nohighlight">\(Z\)</span>-rotation, the identity gate (which does nothing)
is an approximate <span class="math notranslate nohighlight">\(\sqrt{T}\)</span> gate, but not a very good one. The fifth
example “Approximate sqrt(T)” gives a much better approximation using
<span class="math notranslate nohighlight">\(17\)</span> Hadamard, S, and T gates. This example first puts the qubit
<span class="math notranslate nohighlight">\(Q_0\)</span> on the equator of the Bloch sphere using a Hadamard gate, then
applies the <span class="math notranslate nohighlight">\(17\)</span> gate sequence. We use <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_tomography">state
tomography</a> to
observe the final state on the Bloch sphere. Had we applied an exact
<span class="math notranslate nohighlight">\(\sqrt{T}\)</span> gate, the final state would correspond to the point
<span class="math notranslate nohighlight">\((\frac{\sqrt{2+\sqrt{2}}}{2},\frac{\sqrt{2-\sqrt{2}}}{2},0)\approx
(0.92388,0.38268,0)\)</span> on the Bloch sphere. How good is the <span class="math notranslate nohighlight">\(17\)</span> gate
approximation? Arbitrarily good approximations exist, so can you find
a better one? How might you use these circuits to construct an
approximate controlled-<span class="math notranslate nohighlight">\(T\)</span> unitary transformation?</div>
</div>
</div>
<div class="section" id="the-toffoli-gate">
<h2>The Toffoli gate<a class="headerlink" href="#the-toffoli-gate" title="Permalink to this headline">¶</a></h2>
<p>Our final examples, “Toffoli with flips” and “Toffoli state” demonstrate
how to implement the reversible circuit equivalent of the (irreversible,
classical) AND gate using gates from our basis. An AND gate has two
inputs and one output, and outputs 1 if and only if both inputs are 1.
One reason the AND gate is important for computation is that it is a
non-linear transformation (a multiplication). Why do we say AND is
irreversible? Notice that all three inputs <span class="math notranslate nohighlight">\(00\)</span>, <span class="math notranslate nohighlight">\(01\)</span>, and <span class="math notranslate nohighlight">\(10\)</span> result
in an output of 0. If you see that the output of the gate is 0, you
can’t undo the gate because you don’t know which of these three inputs
gave you the result. Since there are three possible answers, even if you
add another output qubit, you won’t have enough information to undo the
gate, since you must distinguish 3 cases, and there are only two choices
for the state of the new qubit. However, it is possible to implement AND
reversibly using 3 wires. This reversible AND gate is called the
<a class="reference external" href="https://en.wikipedia.org/wiki/Toffoli_gate">Toffoli gate</a>
<span class="math notranslate nohighlight">\(TOF|a,b,c\rangle=|a,b,(a\ \mathrm{AND}\ b)\ \mathrm{XOR}\
c\rangle\)</span>.</p>
<p><img alt="image5" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/toffoli_def7k5imm5yhlivn29.png" /></p>
<div class="line-block">
<div class="line">It is not obvious how to build a Toffoli gate from gates in our basis
[<a class="reference external" href="http://journals.aps.org/pra/abstract/10.1103/PhysRevA.52.3457?cm_mc_uid=43781767191014577577895&amp;cm_mc_sid_50200000=1460741020">Barenco et al.,
1995</a>].
The main idea is illustrated in the following figure</div>
</div>
<div class="line-block">
<div class="line"><img alt="image6" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/double-controlled-Uolugr6dbwti0ms4i.png" /></div>
</div>
<div class="line-block">
<div class="line">where <span class="math notranslate nohighlight">\(V=\sqrt{U}\)</span>. By tracing through each value of the two control
qubits, you can convince yourself that a <span class="math notranslate nohighlight">\(U\)</span> gate is applied to the
target qubit if and only if both controls are <span class="math notranslate nohighlight">\(1\)</span>. Using ideas we have
already described, you could now implement each controlled-<span class="math notranslate nohighlight">\(V\)</span> gate to
arrive at some circuit for the doubly-controlled-<span class="math notranslate nohighlight">\(U\)</span> gate. It turns
out that the minimum number of CNOT gates required to implement the
Toffoli gate is 6 [<a class="reference external" href="http://dl.acm.org/citation.cfm?id=2011799">Shende and Markov,
2009</a>]:</div>
</div>
<p><img alt="image7" src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_039c3bf6e6e54d76b8e66152e2f87877/images-classroom/toffoli-6-cnotshgwstno2n3lerk9.png" /></p>
<div class="line-block">
<div class="line">The “Toffoli with flips” example below allows you to choose an input
state by changing the single-qubit gates at the beginning of the
circuit. Right now they are set to Pauli <span class="math notranslate nohighlight">\(X\)</span> on qubits 0 and 1 and
identity on qubit 2, so the default output is <span class="math notranslate nohighlight">\(|111\rangle\)</span>. You
will notice that the example circuit uses 9 CNOT gates instead of the
optimal number 6. This is because we wrote the circuit so it can run
on the real device, which requires inserting a SWAP gate on qubits 1
and 2 near the end of the circuit. Note that we do not undo this swap,
so if the input qubit labels are <span class="math notranslate nohighlight">\(0,1,2\)</span>, the output labels are
actually <span class="math notranslate nohighlight">\(0,2,1\)</span>. This means, for example, that an input of <span class="math notranslate nohighlight">\(010\)</span>
produces output <span class="math notranslate nohighlight">\(001\)</span> (not <span class="math notranslate nohighlight">\(010\)</span>). Finally, the “Toffoli state”
example demonstrates the creation of an interesting 3-qubit entangled
state
<span class="math notranslate nohighlight">\(SWAP_{1,2}TOF|++0\rangle_{0,1,2}=\frac{1}{2}\left(|000\rangle+|001\rangle+|100\rangle+|111\rangle\right)\)</span>
that encodes the <a class="reference external" href="https://en.wikipedia.org/wiki/Truth_table">truth
table</a> of the Toffoli
gate.</div>
</div>
<div class="line-block">
<div class="line">Using the Toffoli gate, it is possible to construct more complex
circuits. A single Toffoli gate is sufficient to implement a modulo-4
addition operation between a pair of 2-bit registers or an
increment-by-one operation from one 2-bit register to another. Can you
find circuits for these operations and run them in the Quantum
Composer?</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>Approximate sqrt(T)</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=b5a0e7376ded40cd7dc1022e778fd799&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-b9096192e0ccec3ff6ac2156b7d080ee.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=b5a0e7376ded40cd7dc1022e778fd799&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>Toffoli with flips</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=4de5b472cdbc8f33b422ee097e26a3f1&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-6d67a99a2c4c052189cdc290465a8a0f.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=4de5b472cdbc8f33b422ee097e26a3f1&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>CNOT (Reversed)</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=56bfed556c0d64e8b92649d5fb206a21&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-6d67a99a2c4c052189cdc290465a7bda.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=56bfed556c0d64e8b92649d5fb206a21&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>SWAP Gate</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd67d26ea&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-cab6cbd8d09fa9a72bd276d9c2c1f6db.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd67d26ea&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>Swap q[0] and q[1]</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd67c616a&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-ac12517d7526a77d19ce104d971a024a.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd67c616a&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>Controlled-Hadamard</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd6706724&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-4568159e2e0816fb088fec7ee6955bbf.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=5537ba08c4b9b9369c47ea0fd6706724&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a><div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>3Q Toffoli state</strong></div>
</div>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=a685beebe7614db5a17b8eddbdcd7e90&sharedCode=true" target="_parent"><img src="https://dal.objectstorage.open.softlayer.com/v1/AUTH_42263efc45184c7ca4742512588a1942/codes/code-ba6021130f09ec06b6a5646bdcfeba8b.png" style="width: 100%; max-width: 600px;"></a>
<a href="https://quantumexperience.ng.bluemix.net/qx/editor?codeId=a685beebe7614db5a17b8eddbdcd7e90&sharedCode=true" target="_blank" style="text-align: right; display: block;">Open in composer</a></div>
</div>


        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="060-Quantum_Algorithms.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>Quantum Algorithms</div>
         </div>
     </a>
     <a id="button-next" href="070-Grover&#39;s_Algorithm.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>Grover’s Algorithm</div>
        </div>
     </a>
        
        </main>
    </div>
  </body>
</html>